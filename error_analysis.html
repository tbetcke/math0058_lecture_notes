
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Principles of backward error analysis &#8212; MATH0058 - Lecture Notes</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Backward error and condition number of linear systems of equations" href="linear_system_error.html" />
    <link rel="prev" title="Floating Point Arithmetic" href="floating_point_arithmetic.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">MATH0058 - Lecture Notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome to MATH0058
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Fundamentals
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="matrix_vector_norms.html">
   Matrix and vector norms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="floating_point_arithmetic.html">
   Floating Point Arithmetic
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Principles of backward error analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_system_error.html">
   Backward error and condition number of linear systems of equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="complexity_notation.html">
   A quick survey of the
   <span class="math notranslate nohighlight">
    \(\mathcal{O}\)
   </span>
   -notation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numpy_and_data_layouts.html">
   Memory layout and Numpy arrays
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  LU Decomposition and its numerical stability
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="lu_decomposition.html">
   Solving linear system with the LU Decomposition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lu_backward_error.html">
   Backward error of the LU decomposition and pivoting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lu_backward_error_examples.html">
   Backward error of the LU decomposition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="python_lu_decomposition.html">
   Implementing the LU decomposition in Python
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Orthogonal decompositions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="qr_decomposition.html">
   The QR Decomposition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="singular_value_decomposition.html">
   The Singular Value decomposition
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Self Check Questions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="week_1_self_check.html">
   Week 1 Self check questions and solutions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="week_2_self_check.html">
   Week 2 Self check questions and solutions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="week_3_self_check.html">
   Week 3 Self check questions and solutions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="week_4_self_check.html">
   Week 4 Self check questions and solutions
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/error_analysis.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#forward-error">
   Forward Error
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#backward-error">
   Backward error
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#condition-number">
   Condition number
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Principles of backward error analysis</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#forward-error">
   Forward Error
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#backward-error">
   Backward error
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#condition-number">
   Condition number
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="principles-of-backward-error-analysis">
<h1>Principles of backward error analysis<a class="headerlink" href="#principles-of-backward-error-analysis" title="Permalink to this headline">¶</a></h1>
<p>Modern error analysis goes back to the seminal work by <a class="reference external" href="https://en.wikipedia.org/wiki/James_H._Wilkinson">James Hardy Wilkinson</a>.
It distinguishes between forward error, that is the error in the result of an algorithm, and the backward error, which is a perturbation
measure for the input data.</p>
<p>In the following we denote by <span class="math notranslate nohighlight">\(f:X\rightarrow Y\)</span> a function that maps data from an input space <span class="math notranslate nohighlight">\(X\)</span> into an output space <span class="math notranslate nohighlight">\(Y\)</span>. Correspondingly,
we define a function <span class="math notranslate nohighlight">\(\tilde{f}\)</span>, which represents an approximate evaluation of <span class="math notranslate nohighlight">\(f\)</span>. Consider for example the solution of the linear system
of equations</p>
<div class="math notranslate nohighlight">
\[
Ay = b
\]</div>
<p>with <span class="math notranslate nohighlight">\(A\in\mathbb{R}^{n\times n}\)</span> and <span class="math notranslate nohighlight">\(b\in\mathbb{R}^n\)</span>. Then the input space is the product space <span class="math notranslate nohighlight">\(X=\mathbb{R}^{n\times n} \times \mathbb{R}^n\)</span> and our
input data is the tuple <span class="math notranslate nohighlight">\((A, b)\in X\)</span>. The output space is <span class="math notranslate nohighlight">\(Y=\mathbb{R}^n\)</span>. The function <span class="math notranslate nohighlight">\(f\)</span> is given as</p>
<div class="math notranslate nohighlight">
\[
f(A, b) = A^{-1}b
\]</div>
<p>and the approximate function <span class="math notranslate nohighlight">\(\tilde{f}\)</span> is for example the Gaussian elimination algorithm in IEEE double precision to compute the solution <span class="math notranslate nohighlight">\(y\)</span>.</p>
<div class="section" id="forward-error">
<h2>Forward Error<a class="headerlink" href="#forward-error" title="Permalink to this headline">¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(y = f(x)\)</span> and <span class="math notranslate nohighlight">\(\tilde{y} = \tilde{f}(y)\)</span>. The relative forward <span class="math notranslate nohighlight">\(E_{rel}\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[
E_{rel} := \frac{\|y - \tilde{y}\|}{\|y\|}.
\]</div>
<p>It measures the difference in output between the exact function <span class="math notranslate nohighlight">\(f\)</span> and the approximate function <span class="math notranslate nohighlight">\(\tilde{f}\)</span> for the same input. In some situations it is not useful to talk about
the relative forward error (i.e. if <span class="math notranslate nohighlight">\(y=0\)</span>). We then use the absolute forward error <span class="math notranslate nohighlight">\(E_{abs} = \|y-\tilde{y}\|\)</span>.</p>
</div>
<div class="section" id="backward-error">
<h2>Backward error<a class="headerlink" href="#backward-error" title="Permalink to this headline">¶</a></h2>
<p>The backward error answers the following question. Given the output <span class="math notranslate nohighlight">\(\tilde{y}\)</span> from the perturbed function <span class="math notranslate nohighlight">\(\tilde{f}\)</span> for the input <span class="math notranslate nohighlight">\(x\)</span>. By how much would I need to perturb <span class="math notranslate nohighlight">\(x\)</span> to an input <span class="math notranslate nohighlight">\(\tilde{x} = x + \Delta x\)</span> so that we have <span class="math notranslate nohighlight">\(\tilde{y} = f(\tilde{x})\)</span>. Hence, it asks
if the exact function <span class="math notranslate nohighlight">\(f\)</span> could produce the same output as <span class="math notranslate nohighlight">\(\tilde{f}\)</span> but with a slight perturbation in the input data. The idea is that our approximate function <span class="math notranslate nohighlight">\(\tilde{f}\)</span> is useful if only a small perturbation is needed for the input data so that <span class="math notranslate nohighlight">\(f\)</span> produces the same output as <span class="math notranslate nohighlight">\(\tilde{f}\)</span> (the perturbation certainly being dependent on the input data).</p>
<p>Formally, the relative backward error is defined as</p>
<div class="math notranslate nohighlight">
\[
\eta_{rel}(\tilde{y}) := \min\{\epsilon: f(x+ \Delta x) = \tilde{y}: \|\Delta x\|\leq \epsilon \|x\|\}.
\]</div>
<p>If the relative backward error for <span class="math notranslate nohighlight">\(\tilde{f}\)</span> is bounded by a small constant times the uncertainty in the input data we say that the algorithm is backward stable. It means that the backward accuracy from the algorithm is as good as we can expect. Hence, for a numerical algorithm on a computer we say that an algorithm is backward stable if its backward error is bounded by a small multiple of machine precision.</p>
</div>
<div class="section" id="condition-number">
<h2>Condition number<a class="headerlink" href="#condition-number" title="Permalink to this headline">¶</a></h2>
<p>The definition of the backward error seems convoluted at first. But it is very useful as the following shows. Assume that <span class="math notranslate nohighlight">\(f\)</span> is differentiable. We have to first order the following statement.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\|y - \tilde{y}\| &amp;\stackrel{(1)}{=} \|f(x) - \tilde{f}(x)\|\\
                  &amp;\stackrel{(2)}{=} \|f(x)  - f(\tilde{x})\|\\
                  &amp;\stackrel{(3)}{\leq} \|f'(x)\|\cdot \|x - \tilde{x}\|
\end{aligned}
\end{split}\]</div>
<p>Equality (2) is possible by choosing <span class="math notranslate nohighlight">\(\tilde{x}\)</span> such that <span class="math notranslate nohighlight">\(\tilde{f}(x) = f(\tilde{x})\)</span>. Hence, <span class="math notranslate nohighlight">\(\Delta x = x- \tilde{x}\)</span> is the backward perturbation associated with the output <span class="math notranslate nohighlight">\(\tilde{y}\)</span>.
The right-hand side in (3) is the
product of the derivative of <span class="math notranslate nohighlight">\(f\)</span> and the size of the backward error. It demonstrates that
the forward error depends on two quantities, namely the sensitivity of <span class="math notranslate nohighlight">\(f\)</span> to small perturbations (i.e. <span class="math notranslate nohighlight">\(\|f'(x)\|\)</span>) and the size of the backward error <span class="math notranslate nohighlight">\(\|x-\tilde{x}\|\)</span>. This is of fundamental importance. We can devise an extremely good evaluation <span class="math notranslate nohighlight">\(\tilde{f}\)</span> with small backward error. If the problem is highly sensitive to perturbations, the output forward error will still be large.</p>
<p>A more general definition of sensitivity is given by the <em>condition number</em>. The relative
condition number <span class="math notranslate nohighlight">\(\kappa_{rel}\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[
\kappa_{rel}(x) := \lim_{\delta\rightarrow 0}\sup_{\|\Delta x\|\leq \delta}\left(\frac{\|\Delta f\|}{\|f\|} / \frac{\|\Delta x\|}{\|x\|}\right)
\]</div>
<p>with <span class="math notranslate nohighlight">\(\Delta f = f(x) - f(\tilde{x})\)</span> being the perturbation in the output data.</p>
<p>Hence, it measures the largest possible ratio of relative output error with respect to relative
input error. If <span class="math notranslate nohighlight">\(f\)</span> is differentiable then <span class="math notranslate nohighlight">\(\kappa_{rel}(x) = \frac{\|f'(x)\|}{\|f(x\|}\|x\|\)</span>.</p>
<p>What is a good condition number in practice? Ideally, we want the condition number to be close
to <span class="math notranslate nohighlight">\(1\)</span> since then errors in the input data are not amplified for the output error. For each
magnitude of the condition number we lose one digit of accuracy in the output error. This
can be seen as follows.</p>
<p>From the definition of the condition number we obtain for differentiable <span class="math notranslate nohighlight">\(f\)</span> that to first order</p>
<div class="math notranslate nohighlight">
\[
\frac{\|\Delta f\|}{\|f\|}\leq \kappa_{rel}(x)\cdot \frac{\|\Delta x\|}{\|x\|},
\]</div>
<p>or in other words the relative forward error is bounded by the product of condition number
and relative backward error.</p>
<p>Assume we work in double precision and that the algorithm is backward stable. Then the backward error is a small multiple of <span class="math notranslate nohighlight">\(\epsilon_{mach}\)</span>. Hence, if the condition number is <span class="math notranslate nohighlight">\(100\)</span> we expect to lose two digits of accuracy in the forward error. If the condition number is in the order of <span class="math notranslate nohighlight">\(\epsilon_{mach}^{-1}\)</span> then we will likely use almost all digits.</p>
<p>If a condition number is small we say that the problem is <em>well-conditioned</em>. If the condition
is large we say that the problem is <em>ill-conditioned</em>. The precise meaning of these terms depends on the requirements of the application.</p>
<p><strong>Note: The condition number is a worst-case bound. In practice, the actual forward error may
be better than predicted by the condition number.</strong></p>
<p><strong>Note: In the following we will generally not use the subscript <span class="math notranslate nohighlight">\(rel\)</span> for relative quantities. Unless otherwise stated we always work with relative quantities.</strong></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="floating_point_arithmetic.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Floating Point Arithmetic</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="linear_system_error.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Backward error and condition number of linear systems of equations</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Timo Betcke<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>