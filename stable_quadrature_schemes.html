
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stable quadrature schemes &#8212; MATH0058 - Lecture Notes</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Week 1 Self check questions and solutions" href="week_1_self_check.html" />
    <link rel="prev" title="Numerical quadrature" href="quadrature.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">MATH0058 - Lecture Notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome to MATH0058
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Fundamentals
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="matrix_vector_norms.html">
   Matrix and vector norms
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="floating_point_arithmetic.html">
   Floating Point Arithmetic
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="error_analysis.html">
   Principles of backward error analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="linear_system_error.html">
   Backward error and condition number of linear systems of equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="complexity_notation.html">
   A quick survey of the
   <span class="math notranslate nohighlight">
    \(\mathcal{O}\)
   </span>
   -notation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numpy_and_data_layouts.html">
   Memory layout and Numpy arrays
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  LU Decomposition and its numerical stability
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="lu_decomposition.html">
   Solving linear system with the LU Decomposition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lu_backward_error.html">
   Backward error of the LU decomposition and pivoting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lu_backward_error_examples.html">
   Backward error of the LU decomposition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="python_lu_decomposition.html">
   Implementing the LU decomposition in Python
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Orthogonal decompositions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="qr_decomposition.html">
   The QR Decomposition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="singular_value_decomposition.html">
   The Singular Value decomposition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="least_squares_problems.html">
   Least Squares Problems
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Eigenvalue problems
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="complex_vector_spaces.html">
   Complex vector spaces
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="eigenvalues_basic_properties.html">
   Basic properties of eigenvalue problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="schur_decomposition.html">
   The Schur decomposition
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="eigenvalues_perturbation_theory.html">
   Perturbation results for eigenvalue problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="computing_eigenvalues.html">
   Computing eigenvalues
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Interpolation and quadrature
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="interpolation_and_quadrature.html">
   Introduction to interpolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quadrature.html">
   Numerical quadrature
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Stable quadrature schemes
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Self Check Questions
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="week_1_self_check.html">
   Week 1 Self check questions and solutions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="week_2_self_check.html">
   Week 2 Self check questions and solutions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="week_3_self_check.html">
   Week 3 Self check questions and solutions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="week_4_self_check.html">
   Week 4 Self check questions and solutions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="week_5_self_check.html">
   Week 5 Self check questions and solutions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="week_6_self_check.html">
   Week 6 Self check questions and solutions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="week_7_self_check.html">
   Week 7 Self check questions and solutions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="week_8_self_check.html">
   Week 8 Self check questions and solutions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="week_9_self_check.html">
   Week 9 Self check questions and solutions
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/stable_quadrature_schemes.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summated-or-composite-quadrature-rules">
   Summated (or composite) quadrature rules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#clenshaw-curtis-quadrature-rules">
   Clenshaw-Curtis Quadrature rules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gauss-quadrature">
   Gauss quadrature
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Stable quadrature schemes</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summated-or-composite-quadrature-rules">
   Summated (or composite) quadrature rules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#clenshaw-curtis-quadrature-rules">
   Clenshaw-Curtis Quadrature rules
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gauss-quadrature">
   Gauss quadrature
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="stable-quadrature-schemes">
<h1>Stable quadrature schemes<a class="headerlink" href="#stable-quadrature-schemes" title="Permalink to this headline">¶</a></h1>
<p>We know that Newton-Cotes quadrature rules are unstable as we decrease the polynomial degree <span class="math notranslate nohighlight">\(n\)</span> of the
underlying interpolation. The reason is Runge’s phenomenon. In the following we will briefly present
some quadrature schemes that do not suffer from this problem and are highly useful in practical computations.</p>
<div class="section" id="summated-or-composite-quadrature-rules">
<h2>Summated (or composite) quadrature rules<a class="headerlink" href="#summated-or-composite-quadrature-rules" title="Permalink to this headline">¶</a></h2>
<p>The idea of summated quadrature rules is simple but powerful. Consider the integral <span class="math notranslate nohighlight">\(I = \int_a^bf(x)dx\)</span>.
Instead of using a Newton-Cotes rule for the whole interval we split up the interval in many small intervals
of size <span class="math notranslate nohighlight">\(h\)</span>.</p>
<p>Let <span class="math notranslate nohighlight">\(x_j = a + jh\)</span> for <span class="math notranslate nohighlight">\(h = (b-a)/N\)</span>, <span class="math notranslate nohighlight">\(j = 0, \dots, N\)</span> be N+1 distinct points with <span class="math notranslate nohighlight">\(x_0=a\)</span> and <span class="math notranslate nohighlight">\(x_N=b\)</span>.</p>
<p>We write</p>
<div class="math notranslate nohighlight">
\[
I = \int_{a}^{b}f(x)dx = \sum_{j=0}^{N-1} \int_{x_j}^{x_{j+1}}f(x)dx.
\]</div>
<p>Each integral is now posed on a small interval of size <span class="math notranslate nohighlight">\(h\)</span>. Instead of applying the Newton-Cotes rule to the
large interval we apply the Newton-Cotes rule to each subinterval. Let us demonstrate this with the trapezoid rule</p>
<div class="math notranslate nohighlight">
\[
\int_{a}^{b}f(x)dx \approx \frac{b-a}{2} \left(f(b) + f(a)\right).
\]</div>
<p>Applying this rule to each subinterval <span class="math notranslate nohighlight">\([x_j, x_{j+1}]\)</span> we obtain</p>
<div class="math notranslate nohighlight">
\[
I\approx \frac{h}{2}\sum_{j=0}^{N-1}\left(f(x_{j+1}) + f(x_j)\right).
\]</div>
<p>Note that for each interior point <span class="math notranslate nohighlight">\(x_j\)</span> with <span class="math notranslate nohighlight">\(0&lt;j&lt;N\)</span> the corresponding value <span class="math notranslate nohighlight">\(f(x_j)\)</span> appears twice. We hence
have the very simple expression</p>
<div class="math notranslate nohighlight">
\[
I\approx \frac{1}{2}f(a) + \sum_{j=1}^{N-1}f(x_j) + \frac{1}{2}f(b).
\]</div>
<p>It is possible to show that the rate of convergence of this rule is quadratic in <span class="math notranslate nohighlight">\(h\)</span> for sufficiently smooth functions,
that is the error decreases with <span class="math notranslate nohighlight">\(\mathcal{O}(h^2)\)</span>. But what happened to Runge’s phenomenon?</p>
<p>The trick is that we are not increasing the polynomial degree <span class="math notranslate nohighlight">\(N\)</span> but keep it fixed. We rather decrease the
interval size <span class="math notranslate nohighlight">\(h\)</span>. So Runge’s phenomenon is irrelevant for this rule as it only applies for growing polynomial degree.</p>
<p>If <span class="math notranslate nohighlight">\(f\)</span> is periodic with period <span class="math notranslate nohighlight">\((b - a)\)</span> the composite trapezoid rule becomes even simpler. In that case we have
<span class="math notranslate nohighlight">\(f(a) = f(b)\)</span> and</p>
<div class="math notranslate nohighlight">
\[
I\approx h\sum_{j=0}^{N-1}f(x_j).
\]</div>
<p>For periodic and analytic functions one can show that this quadrature rule even converges with exponential accuracy.
This is a feature used by many practical fast algorithms.</p>
</div>
<div class="section" id="clenshaw-curtis-quadrature-rules">
<h2>Clenshaw-Curtis Quadrature rules<a class="headerlink" href="#clenshaw-curtis-quadrature-rules" title="Permalink to this headline">¶</a></h2>
<p>We define Chebychev points as follows.
Let <span class="math notranslate nohighlight">\(\theta_j = \frac{j}{N+1}\pi\)</span> for <span class="math notranslate nohighlight">\(j = 0, \dots, N+1\)</span> and define</p>
<p><span class="math notranslate nohighlight">\(z_j = e^{i\theta_j}\)</span>.</p>
<p>The Chebychev points are defined as <span class="math notranslate nohighlight">\(x_j = \frac{1}{2}\left(z_j + z_j^{-1}\right) = \text{Re}\{z_j\}\)</span>.</p>
<p>Chebychev points have the property that they cluster towards the boundary of the interval <span class="math notranslate nohighlight">\([-1, 1]\)</span>.
It is this property that allows them to overcome the Runge phenomenon. It is possible to show that
interpolation in Chebychev points is completely stable, no matter the number of points. Moreover,
if we return to the question of approximation of functions via interpolation it is possible to show that
interpolation polynomials in Chebychev points converge against the functions if it is sufficiently smooth.</p>
<p>Quarature in Chebychev points is called Clenshaw-Curtis quadrature. It is highly efficient for numerically
integrating smooth functions and remains stable for large number of quadrature points.</p>
</div>
<div class="section" id="gauss-quadrature">
<h2>Gauss quadrature<a class="headerlink" href="#gauss-quadrature" title="Permalink to this headline">¶</a></h2>
<p>The final quadrature technique that we want to mention is Gauss quadrature. The basic idea is the following.</p>
<p>Consider a quadrature rule <span class="math notranslate nohighlight">\(I\approx \sum_{j=0}^N f(x_j)\omega_j\)</span>. We have
two sets of unknowns, the points <span class="math notranslate nohighlight">\(x_j\)</span> and the weights <span class="math notranslate nohighlight">\(\omega_j\)</span>. Gauss quadrature rules
are designed in such a way as to integrate polynomials with as high order as possible, exactly.</p>
<p>We have <span class="math notranslate nohighlight">\(2n+2\)</span> unknowns (the <span class="math notranslate nohighlight">\(n+1\)</span> quadrature points and associated weights). We can therefore
hope to integrate exactly polynomials up to degree <span class="math notranslate nohighlight">\(2n+1\)</span>, which are defined by <span class="math notranslate nohighlight">\(2n+2\)</span> coefficients. Indeed,
that is exactly what Gauss quadrature is able to do.</p>
<p>The main drawback of Gauss quadrature is the more involved computation of the nodes and weights. We will not
go into detail of this here. However, this is a step that only needs to be performed once.
One can then simply tabulate the nodes and weights in the program code without recomputing them. This is exactly
what is done in many practical applications that require quadrature.</p>
<p>Traditionally, Gauss quadrature is preferred over Clenshaw-Curtis quadrature since
it integrates polynomials of higher order exactly (Clenshaw-Curtis is only exact for polynomials up to degree <span class="math notranslate nohighlight">\(n\)</span>).
However, this is not the whole story and recent work by Trefethen shows that in practice
both rules are similarly accurate for the integration of sufficiently smooth functions.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="quadrature.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Numerical quadrature</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="week_1_self_check.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Week 1 Self check questions and solutions</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Timo Betcke<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>